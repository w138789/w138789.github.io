
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>linux源码配置php环境 | PHP</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="Su">
    
    <meta name="description" content="一、安装Apache2.2.22tar  -zxvf httpd-2.2.22.tar.gzcd /httpd-2.2.22./configure --prefix=/usr/local/apache2 --enable-module=sharedmakemake installcd /usr/lo">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="PHP" title="PHP"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="PHP">PHP</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.sujianxun.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/03/07/linux源码配置php环境/" title="linux源码配置php环境" itemprop="url">linux源码配置php环境</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://www.sujianxun.com" title="Su">Su</a>
    </p>
  <p class="article-time">
    <time datetime="2017-03-07T02:20:13.000Z" itemprop="datePublished">2017-03-07</time>
    更新日期:<time datetime="2017-08-03T03:41:55.181Z" itemprop="dateModified">2017-08-03</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
		</div>
		
		<p>一、安装Apache2.2.22<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">tar  -zxvf httpd-2.2.22.tar.gz</div><div class="line"><span class="built_in">cd</span> /httpd-2.2.22</div><div class="line">./configure --prefix=/usr/<span class="built_in">local</span>/apache2 --<span class="built_in">enable</span>-module=shared</div><div class="line">make</div><div class="line">make install</div><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/apache2/bin</div><div class="line">./apachectl -k start //启动</div><div class="line">./apachectl -k restart //重启</div><div class="line">./apachectl -k stop //停止</div></pre></td></tr></table></figure></p>
<p>配置文件(满足最基本的配置)<br>编辑 /usr/local/apache2/conf/httpd.conf 文件<br>找到：<br>AddType  application/x-compress .Z<br>AddType application/x-gzip .gz .tgz<br>在后面添加：<br>AddType application/x-httpd-php .php（使Apcche支持PHP）<br>AddType application/x-httpd-php-source .php5<br>找到：</p>
<p><ifmodule dir_module=""><br>DirectoryIndex index.html<br></ifmodule><br>添加：</p>
<p><ifmodule dir_module=""><br>DirectoryIndex index.html index.php<br></ifmodule><br>找到：<br>＃ServerName www.example.com:80<br>修改为：<br>ServerName 127.0.0.1:80或者ServerName localhost:80<br>记得要去掉前面的“＃” </p>
<p>安装nginx<br>tar  -zxvf nginx-1.13.0.tar.gz<br>cd /nginx-1.13.0<br>./configure –prefix=/usr/local/nginx<br>make &amp;&amp; make install<br>配置开机启动脚本<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">vim /etc/init.d/nginx</div><div class="line"></div><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># nginx - this script starts and stops the nginx daemon</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># chkconfig:   - 85 15</span></div><div class="line"><span class="comment"># description:  Nginx is an HTTP(S) server, HTTP(S) reverse \</span></div><div class="line"><span class="comment">#               proxy and IMAP/POP3 proxy server</span></div><div class="line"><span class="comment"># processname: nginx</span></div><div class="line"><span class="comment"># config:      /etc/nginx/nginx.conf</span></div><div class="line"><span class="comment"># config:      /etc/sysconfig/nginx</span></div><div class="line"><span class="comment"># pidfile:     /var/run/nginx.pid</span></div><div class="line"></div><div class="line"><span class="comment"># Source function library.</span></div><div class="line">. /etc/rc.d/init.d/<span class="built_in">functions</span></div><div class="line"></div><div class="line"><span class="comment"># Source networking configuration.</span></div><div class="line">. /etc/sysconfig/network</div><div class="line"></div><div class="line"><span class="comment"># Check that networking is up.</span></div><div class="line">[ <span class="string">"<span class="variable">$NETWORKING</span>"</span> = <span class="string">"no"</span> ] &amp;&amp; <span class="built_in">exit</span> 0</div><div class="line"></div><div class="line">nginx=<span class="string">"/usr/local/nginx/sbin/nginx"</span></div><div class="line">prog=$(basename <span class="variable">$nginx</span>)</div><div class="line"></div><div class="line">sysconfig=<span class="string">"/etc/sysconfig/<span class="variable">$prog</span>"</span></div><div class="line">lockfile=<span class="string">"/var/lock/subsys/nginx"</span></div><div class="line">pidfile=<span class="string">"/usr/local/nginx/logs/<span class="variable">$&#123;prog&#125;</span>.pid"</span></div><div class="line"></div><div class="line">NGINX_CONF_FILE=<span class="string">"/usr/local/nginx/conf/nginx.conf"</span></div><div class="line"></div><div class="line">[ -f <span class="variable">$sysconfig</span> ] &amp;&amp; . <span class="variable">$sysconfig</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="title">start</span></span>() &#123;</div><div class="line">    [ -x <span class="variable">$nginx</span> ] || <span class="built_in">exit</span> 5</div><div class="line">    [ -f <span class="variable">$NGINX_CONF_FILE</span> ] || <span class="built_in">exit</span> 6</div><div class="line">    <span class="built_in">echo</span> -n $<span class="string">"Starting <span class="variable">$prog</span>: "</span></div><div class="line">    daemon <span class="variable">$nginx</span> -c <span class="variable">$NGINX_CONF_FILE</span></div><div class="line">    retval=$?</div><div class="line">    <span class="built_in">echo</span></div><div class="line">    [ <span class="variable">$retval</span> -eq 0 ] &amp;&amp; touch <span class="variable">$lockfile</span></div><div class="line">    <span class="built_in">return</span> <span class="variable">$retval</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="title">stop</span></span>() &#123;</div><div class="line">    <span class="built_in">echo</span> -n $<span class="string">"Stopping <span class="variable">$prog</span>: "</span></div><div class="line">    killproc -p <span class="variable">$pidfile</span> <span class="variable">$prog</span></div><div class="line">    retval=$?</div><div class="line">    <span class="built_in">echo</span></div><div class="line">    [ <span class="variable">$retval</span> -eq 0 ] &amp;&amp; rm -f <span class="variable">$lockfile</span></div><div class="line">    <span class="built_in">return</span> <span class="variable">$retval</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="title">restart</span></span>() &#123;</div><div class="line">    configtest_q || <span class="built_in">return</span> 6</div><div class="line">    stop</div><div class="line">    start</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="title">reload</span></span>() &#123;</div><div class="line">    configtest_q || <span class="built_in">return</span> 6</div><div class="line">    <span class="built_in">echo</span> -n $<span class="string">"Reloading <span class="variable">$prog</span>: "</span></div><div class="line">    killproc -p <span class="variable">$pidfile</span> <span class="variable">$prog</span> -HUP</div><div class="line">    <span class="built_in">echo</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="title">configtest</span></span>() &#123;</div><div class="line">    <span class="variable">$nginx</span> -t -c <span class="variable">$NGINX_CONF_FILE</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="title">configtest_q</span></span>() &#123;</div><div class="line">    <span class="variable">$nginx</span> -t -q -c <span class="variable">$NGINX_CONF_FILE</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="title">rh_status</span></span>() &#123;</div><div class="line">    status <span class="variable">$prog</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="title">rh_status_q</span></span>() &#123;</div><div class="line">    rh_status &gt;/dev/null 2&gt;&amp;1</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># Upgrade the binary with no downtime.</span></div><div class="line"><span class="function"><span class="title">upgrade</span></span>() &#123;</div><div class="line">    <span class="built_in">local</span> oldbin_pidfile=<span class="string">"<span class="variable">$&#123;pidfile&#125;</span>.oldbin"</span></div><div class="line"></div><div class="line">    configtest_q || <span class="built_in">return</span> 6</div><div class="line">    <span class="built_in">echo</span> -n $<span class="string">"Upgrading <span class="variable">$prog</span>: "</span></div><div class="line">    killproc -p <span class="variable">$pidfile</span> <span class="variable">$prog</span> -USR2</div><div class="line">    retval=$?</div><div class="line">    sleep 1</div><div class="line">    <span class="keyword">if</span> [[ -f <span class="variable">$&#123;oldbin_pidfile&#125;</span> &amp;&amp; -f <span class="variable">$&#123;pidfile&#125;</span> ]];  <span class="keyword">then</span></div><div class="line">        killproc -p <span class="variable">$oldbin_pidfile</span> <span class="variable">$prog</span> -QUIT</div><div class="line">        success $<span class="string">"<span class="variable">$prog</span> online upgrade"</span></div><div class="line">        <span class="built_in">echo</span> </div><div class="line">        <span class="built_in">return</span> 0</div><div class="line">    <span class="keyword">else</span></div><div class="line">        failure $<span class="string">"<span class="variable">$prog</span> online upgrade"</span></div><div class="line">        <span class="built_in">echo</span></div><div class="line">        <span class="built_in">return</span> 1</div><div class="line">    <span class="keyword">fi</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># Tell nginx to reopen logs</span></div><div class="line"><span class="function"><span class="title">reopen_logs</span></span>() &#123;</div><div class="line">    configtest_q || <span class="built_in">return</span> 6</div><div class="line">    <span class="built_in">echo</span> -n $<span class="string">"Reopening <span class="variable">$prog</span> logs: "</span></div><div class="line">    killproc -p <span class="variable">$pidfile</span> <span class="variable">$prog</span> -USR1</div><div class="line">    retval=$?</div><div class="line">    <span class="built_in">echo</span></div><div class="line">    <span class="built_in">return</span> <span class="variable">$retval</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></div><div class="line">    start)</div><div class="line">        rh_status_q &amp;&amp; <span class="built_in">exit</span> 0</div><div class="line">        <span class="variable">$1</span></div><div class="line">        ;;</div><div class="line">    stop)</div><div class="line">        rh_status_q || <span class="built_in">exit</span> 0</div><div class="line">        <span class="variable">$1</span></div><div class="line">        ;;</div><div class="line">    restart|configtest|reopen_logs)</div><div class="line">        <span class="variable">$1</span></div><div class="line">        ;;</div><div class="line">    force-reload|upgrade) </div><div class="line">        rh_status_q || <span class="built_in">exit</span> 7</div><div class="line">        upgrade</div><div class="line">        ;;</div><div class="line">    reload)</div><div class="line">        rh_status_q || <span class="built_in">exit</span> 7</div><div class="line">        <span class="variable">$1</span></div><div class="line">        ;;</div><div class="line">    status|status_q)</div><div class="line">        rh_<span class="variable">$1</span></div><div class="line">        ;;</div><div class="line">    condrestart|try-restart)</div><div class="line">        rh_status_q || <span class="built_in">exit</span> 7</div><div class="line">        restart</div><div class="line">	    ;;</div><div class="line">    *)</div><div class="line">        <span class="built_in">echo</span> $<span class="string">"Usage: <span class="variable">$0</span> &#123;start|stop|reload|configtest|status|force-reload|upgrade|restart|reopen_logs&#125;"</span></div><div class="line">        <span class="built_in">exit</span> 2</div><div class="line"><span class="keyword">esac</span></div><div class="line"></div><div class="line">:wq</div><div class="line">chmod 755 nginx</div><div class="line">chkconfig --add nginx</div><div class="line">chkconfig nginx on</div></pre></td></tr></table></figure></p>
<p>二.安装mysql<br>1、下载地址<br>wget <a href="http://downloads.mysql.com/archives/get/file/mysql-5.6.27-linux-glibc2.5-x86_64.tar.gz" target="_blank" rel="external">http://downloads.mysql.com/archives/get/file/mysql-5.6.27-linux-glibc2.5-x86_64.tar.gz</a><br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"><span class="comment">#解压</span></div><div class="line">tar -zxvf mysql-5.6.33-linux-glibc2.5-x86_64.tar.gz</div><div class="line"><span class="comment">#复制解压后的mysql目录</span></div><div class="line">cp -r mysql-5.6.33-linux-glibc2.5-x86_64 /usr/<span class="built_in">local</span>/mysql</div><div class="line"><span class="comment">#添加用户组</span></div><div class="line">groupadd mysql</div><div class="line"><span class="comment">#添加用户mysql 到用户组mysql</span></div><div class="line">useradd -g mysql mysql</div><div class="line"><span class="comment">#安装</span></div><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/mysql/&lt;br&gt;mkdir ./data/mysql</div><div class="line">chown -R mysql:mysql ./</div><div class="line">./scripts/mysql_install_db --user=mysql --datadir=/usr/<span class="built_in">local</span>/mysql/data/mysql</div><div class="line">cp support-files/mysql.server /etc/init.d/mysqld</div><div class="line">chmod 755 /etc/init.d/mysqld</div><div class="line">cp support-files/my-default.cnf /etc/my.cnf</div><div class="line"><span class="comment">#修改配置文件</span></div><div class="line">vim /etc/my.cnf</div><div class="line"><span class="comment">#添加</span></div><div class="line"><span class="comment">#修改编码</span></div><div class="line">character-set-server=utf8</div><div class="line"><span class="comment">#修改默认存储引擎</span></div><div class="line">default-storage-engine=MyISAM </div><div class="line">:wq</div><div class="line"><span class="comment">#修改启动脚本</span></div><div class="line">vi /etc/init.d/mysqld</div><div class="line"><span class="comment">#修改项：</span></div><div class="line">basedir=/usr/<span class="built_in">local</span>/mysql/</div><div class="line">datadir=/usr/<span class="built_in">local</span>/mysql/data/mysql</div><div class="line"><span class="comment">#启动服务</span></div><div class="line">service mysqld start</div><div class="line"><span class="comment">#测试连接</span></div><div class="line">./mysql/bin/mysql -uroot</div><div class="line"><span class="comment">#查看mysql编码及程序信息</span></div><div class="line">\s</div><div class="line"><span class="comment">#启动mysql</span></div><div class="line">service mysqld start</div><div class="line"><span class="comment">#关闭mysql</span></div><div class="line">service mysqld stop</div><div class="line"><span class="comment">#查看运行状态</span></div><div class="line">service mysqld status</div><div class="line">6.1 配置环境变量</div><div class="line">vim /etc/profile</div><div class="line">PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/mysql/bin</div><div class="line"><span class="built_in">export</span> PATH</div></pre></td></tr></table></figure></p>
<p>三、安装PHP </p>
<ol>
<li>解压<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">tar -zxvf php-5.3.16.tar.gz</div><div class="line"><span class="built_in">cd</span> /php-5.3.16</div><div class="line">./configure --prefix=/usr/<span class="built_in">local</span>/php \</div><div class="line">--with-apxs2=/usr/<span class="built_in">local</span>/apache2/bin/apxs \</div><div class="line">--with-mysqli=/usr/<span class="built_in">local</span>/mysql/bin/mysql_config \</div><div class="line">--with-pdo-mysql=/usr/<span class="built_in">local</span>/mysql/ \</div><div class="line">--with-mysql \</div><div class="line"> --<span class="built_in">enable</span>-fpm \</div><div class="line">--with-php-config=/usr/<span class="built_in">local</span>/php/bin/php-config  注意mysql_config 的路径</div><div class="line"></div><div class="line"><span class="comment">#下面是nginx的</span></div><div class="line">./configure --prefix=/usr/<span class="built_in">local</span>/php \</div><div class="line">--with-mysqli=/usr/<span class="built_in">local</span>/mysql/bin/mysql_config \</div><div class="line">--with-pdo-mysql=/usr/<span class="built_in">local</span>/mysql/ \</div><div class="line">--with-mysql \</div><div class="line">--<span class="built_in">enable</span>-fpm \</div><div class="line">--with-gd \</div><div class="line">--with-jpeg-dir \</div><div class="line">--with-freetype-dir=/usr/include/freetype2/freetype/ \</div><div class="line">--with-php-config=/usr/<span class="built_in">local</span>/php/bin/php-config</div></pre></td></tr></table></figure>
</li>
</ol>
<p>注意这里有一个-with-apxs2=/usr/local/apache/bin/apxs选项，<br>其中apxs是在安装Apache时产生的，apxs是一个为Apache HTTP服务器编译和安装扩展模块的工具，<br>使之可以用由mod_so提供的LoadModule指令在运行时加载到Apache服务器中。<br>我的理解是通过这个工具把PHP模块动态加载到Apache中<br>出现错误:configure: error: xml2-config not found. Please check your libxml2 installation.<br>运行yum install libxml2，然后再运行yum install libxml2-devel安装完毕后，重新运行上面的./configure命令。</p>
<ol>
<li>编译<br>make   </li>
<li>测试编译<br>make test   </li>
<li>安装<br>make install<br>cp /usr/local/src/php-5.3.16/php.ini-development  /usr/local/php/lib/php.ini<br>把原来位于源代码里面的php.ini-development拷贝到/usr/local/php/lib/php.ini下，<br>并且重命名为php.ini<br>5、测试 写一个页面test.php,放在apache的web目录下，测试上面用命令创建的数据库<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">&lt;?php </div><div class="line"><span class="variable">$mysqli</span>=new mysqli();</div><div class="line"><span class="variable">$mysqli</span>-&gt;connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'123456'</span>,<span class="string">'gywtest'</span>);</div><div class="line">// 创建查询</div><div class="line"><span class="variable">$sqlstr</span>=<span class="string">'select * from student'</span>;</div><div class="line">//发送查询给MySql</div><div class="line"><span class="variable">$result</span>=<span class="variable">$mysqli</span>-&gt;query(<span class="variable">$sqlstr</span>);</div><div class="line"><span class="keyword">while</span>(<span class="variable">$row</span>=<span class="variable">$result</span>-&gt;fetch_object())</div><div class="line">&#123; </div><div class="line"><span class="variable">$name</span>=<span class="variable">$row</span>-&gt;stuname;</div><div class="line"><span class="built_in">echo</span> <span class="variable">$name</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>安装CURL扩展<br>进入源码目录<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"><span class="built_in">cd</span> php/</div><div class="line"><span class="built_in">cd</span> /ext/curl</div><div class="line">make clean</div><div class="line">/usr/<span class="built_in">local</span>/php/bin/phpize</div><div class="line">./configure    --with-php-config=/usr/<span class="built_in">local</span>/php/bin/php-config   --with-curl</div><div class="line">make &amp;&amp; make install</div><div class="line">查看  curl.so文件是否安装到这个目录下</div><div class="line">ll /usr/<span class="built_in">local</span>/php/lib/php/extensions/no-debug-non-zts-20060613/</div><div class="line">vi /usr/<span class="built_in">local</span>/php/lib/php.ini</div><div class="line">extension_dir = <span class="string">"/usr/local/php5/lib/php/extensions/no-debug-non-zts-20060613/"</span>；</div><div class="line">添加如下一行：</div><div class="line">extension=curl.so</div><div class="line">查看是否加载了CURL扩展</div><div class="line">/usr/<span class="built_in">local</span>/php/bin/php -m</div><div class="line">重启http</div></pre></td></tr></table></figure></p>
<p>安装gd扩展<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">1.进入相应外部库文件位置</div><div class="line">vim /root/php-5.6.9/ext/gd  </div><div class="line"></div><div class="line">提示：在源码包的ext目录下会有很多外部库文件的源码，不知道是不是全部都在那里面。</div><div class="line">2.安装GD库相应的依赖</div><div class="line"></div><div class="line">1.安装vpx</div><div class="line">yum install -y libvpx libvpx-devel  </div><div class="line"></div><div class="line">2.安装jpeg </div><div class="line">yum install -y libjpeg-turbo libjpeg-turbo-devel  </div><div class="line"></div><div class="line">3.安装png </div><div class="line">yum install -y libpng libpng-devel  </div><div class="line"></div><div class="line">4.安装fretype</div><div class="line">yum install -y freetype freetype-devel  </div><div class="line"></div><div class="line">提示：我用的是阿里云的源，这些软件都可以找到，如果不行的话请自行切换</div><div class="line"></div><div class="line"></div><div class="line">3.配置编译GD库</div><div class="line">/usr/<span class="built_in">local</span>/php/bin/phpize &amp;&amp; ./configure --with-php-config=/usr/<span class="built_in">local</span>/php/bin/php-config --with-vpx-dir=/usr/<span class="built_in">local</span>/ --with-jpeg-dir=/usr/<span class="built_in">local</span>/  --with-png-dir=/usr/<span class="built_in">local</span>/ --with-freetype-dir=/usr/<span class="built_in">local</span> &amp;&amp; make &amp;&amp; make install</div><div class="line"></div><div class="line">添加如下一行：</div><div class="line">vim /usr/<span class="built_in">local</span>/php/lib/php.ini</div><div class="line">extension=gd.so</div></pre></td></tr></table></figure></p>
<p>如果不行重新编绎安装php 重新安装前先make clean</p>
<p>安装mcrypt扩展<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">1 先去http://www.sourceforge.net下载Libmcrypt,mhash,mcrypt安装包 ,下面是我找到的链接</div><div class="line"></div><div class="line">libmcrypt-2.5.8.tar.gz</div><div class="line">下载地址: http://sourceforge.net/project/showfiles.php?group_id=87941&amp;package_id=91774&amp;release_id=487459</div><div class="line">mhash-0.9.9.tar.gz</div><div class="line">下载地址: http://sourceforge.net/project/showfiles.php?group_id=4286&amp;package_id=4300&amp;release_id=645636</div><div class="line">mcrypt-2.6.8.tar.gz</div><div class="line">下载地址: http://sourceforge.net/project/showfiles.php?group_id=87941&amp;package_id=91948&amp;release_id=642101</div><div class="line"></div><div class="line">2 先安装Libmcrypt</div><div class="line"></div><div class="line"><span class="comment">#tar -zxvf libmcrypt-2.5.8.tar.gz</span></div><div class="line"></div><div class="line">   <span class="comment">#cd libmcrypt-2.5.8</span></div><div class="line"></div><div class="line">   <span class="comment">#./configure</span></div><div class="line"></div><div class="line">   <span class="comment">#make</span></div><div class="line"></div><div class="line">   <span class="comment">#make install 说明：libmcript默认安装在/usr/local</span></div><div class="line"></div><div class="line">3 安装mhash</div><div class="line"></div><div class="line">   <span class="comment">#tar -zxvf mhash-0.9.9.9.tar.gz</span></div><div class="line"></div><div class="line">   <span class="comment">#cd mhash-0.9.9.9</span></div><div class="line"></div><div class="line">   <span class="comment">#./configure</span></div><div class="line"></div><div class="line">   <span class="comment">#make</span></div><div class="line"></div><div class="line">   <span class="comment">#make install</span></div><div class="line"></div><div class="line">4 安装mcrypt</div><div class="line"></div><div class="line">   <span class="comment">#tar -zxvf mcrypt-2.6.8.tar.gz</span></div><div class="line"></div><div class="line">   <span class="comment">#cd mcrypt-2.6.8</span></div><div class="line"></div><div class="line">   <span class="comment">#LD_LIBRARY_PATH=/usr/local/lib ./configure</span></div><div class="line"></div><div class="line">   <span class="comment">#make</span></div><div class="line"></div><div class="line">   <span class="comment">#make install</span></div><div class="line">5 安装php扩展</div><div class="line"><span class="built_in">cd</span> /root/php-5.6.3/ext/mcrypt</div><div class="line">/usr/<span class="built_in">local</span>/php/bin/phpize</div><div class="line">./configure</div><div class="line">make &amp;&amp; make install</div><div class="line">添加*.so加载</div><div class="line">vim /usr/<span class="built_in">local</span>/php/lib/php.ini</div><div class="line">extension=mcrypt.so</div></pre></td></tr></table></figure></p>
<p>nginx 支持php环境<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">nginx最常用的方法是利用 tcp/ip 协议连接 phpfastcgi 接口, 因此要连接php必须先启动fastcgi程序.</div><div class="line"></div><div class="line">启动方法：</div><div class="line"></div><div class="line">1<span class="comment"># /usr/local/bin/php-cgi-b 127.0.0.1:9000 -c /usr/local/php/lib/php.ini</span></div><div class="line"></div><div class="line">2配置php-fpm启动</div><div class="line">cp /usr/<span class="built_in">local</span>/php/etc/php-fpm.conf.default /usr/<span class="built_in">local</span>/php/etc/php-fpm.conf</div><div class="line">cp init.d.php-fpm /etc/init.d/php-fpm</div><div class="line">chmod a+x /etc/init.d/php-fpm</div><div class="line">service php-fpm start</div><div class="line">//php7.1安装注意:</div><div class="line">cp /usr/<span class="built_in">local</span>/php-7.1.1/etc/php-fpm.d/www.conf.default /usr/<span class="built_in">local</span>/php-7.1.1/etc/php-fpm.d/www.conf</div><div class="line"></div><div class="line"></div><div class="line">vim /usr/<span class="built_in">local</span>/nginx/conf/nginx.conf</div><div class="line"><span class="comment">#增加 </span></div><div class="line">location ~ \.php(.*)$  &#123;</div><div class="line">                root            /var/www;</div><div class="line">                fastcgi_pass   127.0.0.1:9000;</div><div class="line">                fastcgi_index  index.php;</div><div class="line">                fastcgi_split_path_info  ^((?U).+\.php)(/?.+)$;</div><div class="line">                fastcgi_param  SCRIPT_FILENAME  <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</div><div class="line">                fastcgi_param  PATH_INFO  <span class="variable">$fastcgi_path_info</span>;</div><div class="line">                fastcgi_param  PATH_TRANSLATED  <span class="variable">$document_root</span><span class="variable">$fastcgi_path_info</span>;</div><div class="line">                include        fastcgi_params;</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
  
	</div>
		<footer class="article-footer clearfix">


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/linux/">linux</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://www.sujianxun.com/2017/03/07/linux源码配置php环境/" data-title="linux源码配置php环境 | PHP" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2017/03/09/linux邮件服务器配置/" title="linux邮件服务器配置">
  <strong>PREVIOUS:</strong><br/>
  <span>
  linux邮件服务器配置</span>
</a>
</div>


<div class="next">
<a href="/2017/03/05/linux虚拟机LVS+DR负载均衡配置/"  title="linux虚拟机LVS+DR负载均衡配置">
 <strong>NEXT:</strong><br/> 
 <span>linux虚拟机LVS+DR负载均衡配置
</span>
</a>
</div>

</nav>

	
</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/designPattern/" title="designPattern">designPattern<sup>2</sup></a></li>
		
			<li><a href="/categories/git/" title="git">git<sup>4</sup></a></li>
		
			<li><a href="/categories/linux/" title="linux">linux<sup>13</sup></a></li>
		
			<li><a href="/categories/mysql/" title="mysql">mysql<sup>5</sup></a></li>
		
			<li><a href="/categories/others/" title="others">others<sup>3</sup></a></li>
		
			<li><a href="/categories/php/" title="php">php<sup>2</sup></a></li>
		
			<li><a href="/categories/win-svn/" title="win_svn">win_svn<sup>1</sup></a></li>
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	
	<section class="info">
		<p> Hello ,I&#39;m Su Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font clearfix">
		
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2017 
		
		<a href="http://www.sujianxun.com" target="_blank" title="Su">Su</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>






  </body>
</html>
